{% if tracks is empty %}
<div class="empty-state">
    <div class="empty-state-icon">ðŸ“š</div>
    <p>Your library is empty</p>
    <p style="font-size: 13px; margin-top: 8px;">Search and download music to build your collection</p>
</div>
{% else %}
{% for track in tracks %}
<div class="result-item track-item">
    <input type="checkbox" class="track-checkbox" name="tracks[]" value="{{ track.id }}">
    <button type="button" class="track-play-btn" data-id="{{ track.id }}" onclick="playTrack('{{ track.id }}', '{{ track.title|e('js') }}', '{{ track.artist|e('js') }}', '{{ track.thumbnail|e('js') }}')">
        â–¶
    </button>
    {% if track.thumbnail %}
    <img class="result-thumb" src="{{ track.thumbnail }}" alt="" loading="lazy" style="width: 48px; height: 48px;" onerror="this.style.display='none';this.nextElementSibling.style.display='flex';">
    <div class="result-thumb" style="display:none;width:48px;height:48px;background:var(--bg-tertiary);align-items:center;justify-content:center;font-size:18px;">ðŸŽµ</div>
    {% else %}
    <div class="result-thumb" style="width:48px;height:48px;background:var(--bg-tertiary);display:flex;align-items:center;justify-content:center;font-size:18px;">ðŸŽµ</div>
    {% endif %}
    <div class="result-info" style="flex: 1;">
        <div class="result-title">{{ track.title }}</div>
        <div class="result-meta">
            {{ track.artist }}
            {% if track.duration %}
            â€¢ {{ (track.duration / 60)|number_format(0) }}:{{ '%02d'|format(track.duration % 60) }}
            {% endif %}
        </div>
        <div class="result-badges">
            {% if track.source %}
            <span class="source-badge {{ track.source }}">{{ track.source|upper }}</span>
            {% endif %}
            <span class="source-badge" style="background: var(--bg-tertiary); color: var(--text-secondary);">{{ track.codec|upper }}</span>
            {% if track.bitrate %}
            <span style="font-size: 11px; color: var(--text-secondary);">{{ track.bitrate }} kbps</span>
            {% endif %}
        </div>
    </div>
    <button 
        type="button"
        class="clear-btn" 
        style="padding: 6px 12px; font-size: 12px;"
        hx-delete="/library/{{ track.id }}"
        hx-target="closest .result-item"
        hx-swap="outerHTML"
        hx-confirm="Delete '{{ track.title }}'?"
    >
        ðŸ—‘
    </button>
</div>
{% endfor %}
{% endif %}
