{% if error %}
<div class="empty-state">
    <div class="empty-state-icon">âš ï¸</div>
    <p style="color: var(--error);">{{ error }}</p>
</div>
{% elseif results is empty %}
<div class="empty-state">
    <div class="empty-state-icon">ğŸ”</div>
    <p>{{ message|default('No results found') }}</p>
</div>
{% else %}
{% for result in results %}
<form class="result-item" 
      hx-post="/download" 
      hx-swap="outerHTML" 
      hx-target="this"
      style="cursor: pointer;">
    <input type="hidden" name="video_id" value="{{ result.video_id }}">
    <input type="hidden" name="source" value="{{ result.source }}">
    <input type="hidden" name="title" value="{{ result.title|e('html_attr') }}">
    <input type="hidden" name="artist" value="{{ result.artist|e('html_attr') }}">
    <input type="hidden" name="url" value="{{ result.url }}">
    <input type="hidden" name="thumbnail" value="{{ result.thumbnail }}">
    <input type="hidden" name="convert_to_flac" value="1">
    
    {% if result.thumbnail %}
    <img class="result-thumb" src="{{ result.thumbnail }}" alt="" loading="lazy" onerror="this.style.display='none';this.nextElementSibling.style.display='flex';">
    <div class="result-thumb" style="display:none;background:var(--bg-tertiary);align-items:center;justify-content:center;font-size:24px;">ğŸµ</div>
    {% else %}
    <div class="result-thumb" style="background:var(--bg-tertiary);display:flex;align-items:center;justify-content:center;font-size:24px;">ğŸµ</div>
    {% endif %}
    
    <div class="result-info">
        <div class="result-title">{{ result.title }}</div>
        <div class="result-meta">{{ result.artist }}</div>
        <div class="result-badges">
            <span class="source-badge {{ result.source }}">{{ result.source|upper }}</span>
            {% if result.quality %}
            <span class="quality-badge {% if result.quality == 'HI_RES_LOSSLESS' %}hires{% elseif result.quality == 'LOSSLESS' %}flac{% endif %}">{{ result.quality == 'HI_RES_LOSSLESS' ? 'Hi-Res' : (result.quality == 'LOSSLESS' ? 'Lossless' : result.quality) }}</span>
            {% endif %}
            <span class="result-duration">{{ result.duration_string }}</span>
        </div>
    </div>
    <button type="submit" class="download-btn">â¬‡</button>
</form>
{% endfor %}
{% endif %}
